ren (master *+) python $ python train.py mfcc_40_25_10 gg4 3 128
/home/ren/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:34: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
======= processing data =======
========== input shape is : (101, 40) ===========
------------- SUMMARY OF MODEL -------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 101, 40)      0
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 101, 40, 1)   0           input_1[0][0]
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 101, 40, 18)  198         reshape_1[0][0]
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 101, 40, 18)  72          conv2d_1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 101, 40, 18)  0           batch_normalization_1[0][0]
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 101, 40, 18)  3258        activation_1[0][0]
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 101, 40, 18)  72          conv2d_2[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 101, 40, 18)  0           batch_normalization_2[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 50, 20, 18)   0           activation_2[0][0]
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 50, 20, 36)   6516        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 50, 20, 36)   144         conv2d_3[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 50, 20, 36)   0           batch_normalization_3[0][0]
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 50, 20, 36)   12996       activation_3[0][0]
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50, 20, 36)   144         conv2d_4[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50, 20, 36)   0           batch_normalization_4[0][0]
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 25, 10, 36)   0           activation_4[0][0]
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 25, 10, 72)   25992       max_pooling2d_2[0][0]
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 25, 10, 72)   288         conv2d_5[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 25, 10, 72)   0           batch_normalization_5[0][0]
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 25, 10, 72)   51912       activation_5[0][0]
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 25, 10, 72)   288         conv2d_6[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 25, 10, 72)   0           batch_normalization_6[0][0]
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 12, 5, 72)    0           activation_6[0][0]
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 12, 5, 144)   103824      max_pooling2d_3[0][0]
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 12, 5, 144)   576         conv2d_7[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 12, 5, 144)   0           batch_normalization_7[0][0]
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 12, 5, 144)   207504      activation_7[0][0]
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 12, 5, 144)   576         conv2d_8[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 12, 5, 144)   0           batch_normalization_8[0][0]
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 6, 2, 144)    0           activation_8[0][0]
__________________________________________________________________________________________________
global_max_pooling2d_1 (GlobalM (None, 144)          0           max_pooling2d_4[0][0]
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 144)          0           max_pooling2d_4[0][0]
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 288)          0           global_max_pooling2d_1[0][0]
                                                                 global_average_pooling2d_1[0][0]
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 128)          36992       concatenate_1[0][0]
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 128)          512         dense_1[0][0]
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 128)          0           batch_normalization_9[0][0]
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 128)          16512       dropout_1[0][0]
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 128)          512         dense_2[0][0]
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128)          0           batch_normalization_10[0][0]
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 31)           3999        dropout_2[0][0]
==================================================================================================
Total params: 472,887
Trainable params: 471,295
Non-trainable params: 1,592
__________________________________________________________________________________________________
None
--------------------------------------------
========= fitting 1 th model 15:23:36 =========
Epoch 1/65535
420/420 [==============================] - 21s 49ms/step - loss: 0.0968 - categorical_accuracy: 0.4073 - val_loss: 0.0552 - val_categorical_accuracy: 0.6561
Epoch 2/65535
420/420 [==============================] - 19s 45ms/step - loss: 0.0395 - categorical_accuracy: 0.7750 - val_loss: 0.0229 - val_categorical_accuracy: 0.8751
Epoch 3/65535
420/420 [==============================] - 19s 45ms/step - loss: 0.0256 - categorical_accuracy: 0.8610 - val_loss: 0.0171 - val_categorical_accuracy: 0.9041
Epoch 4/65535
420/420 [==============================] - 19s 45ms/step - loss: 0.0197 - categorical_accuracy: 0.8954 - val_loss: 0.0142 - val_categorical_accuracy: 0.9185
Epoch 5/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0164 - categorical_accuracy: 0.9147 - val_loss: 0.0116 - val_categorical_accuracy: 0.9341
Epoch 6/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0139 - categorical_accuracy: 0.9282 - val_loss: 0.0184 - val_categorical_accuracy: 0.8974
Epoch 7/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0124 - categorical_accuracy: 0.9352 - val_loss: 0.0103 - val_categorical_accuracy: 0.9435
Epoch 8/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0111 - categorical_accuracy: 0.9416 - val_loss: 0.0141 - val_categorical_accuracy: 0.9226
Epoch 9/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0099 - categorical_accuracy: 0.9491 - val_loss: 0.0107 - val_categorical_accuracy: 0.9402
Epoch 10/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0091 - categorical_accuracy: 0.9531 - val_loss: 0.0129 - val_categorical_accuracy: 0.9296
Epoch 11/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0082 - categorical_accuracy: 0.9565 - val_loss: 0.0116 - val_categorical_accuracy: 0.9350
Epoch 12/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0076 - categorical_accuracy: 0.9594 - val_loss: 0.0096 - val_categorical_accuracy: 0.9475
Epoch 13/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0068 - categorical_accuracy: 0.9642 - val_loss: 0.0108 - val_categorical_accuracy: 0.9420
Epoch 14/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0064 - categorical_accuracy: 0.9664 - val_loss: 0.0097 - val_categorical_accuracy: 0.9494
Epoch 15/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0058 - categorical_accuracy: 0.9694 - val_loss: 0.0089 - val_categorical_accuracy: 0.9537
Epoch 16/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0052 - categorical_accuracy: 0.9728 - val_loss: 0.0105 - val_categorical_accuracy: 0.9475
Epoch 17/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0048 - categorical_accuracy: 0.9752 - val_loss: 0.0117 - val_categorical_accuracy: 0.9448
Epoch 18/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0045 - categorical_accuracy: 0.9764 - val_loss: 0.0103 - val_categorical_accuracy: 0.9483
Epoch 19/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0040 - categorical_accuracy: 0.9794 - val_loss: 0.0124 - val_categorical_accuracy: 0.9409
Epoch 20/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0038 - categorical_accuracy: 0.9810 - val_loss: 0.0098 - val_categorical_accuracy: 0.9525
Epoch 21/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0034 - categorical_accuracy: 0.9831 - val_loss: 0.0112 - val_categorical_accuracy: 0.9459

Epoch 00021: ReduceLROnPlateau reducing learning rate to 0.2.
Epoch 22/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0022 - categorical_accuracy: 0.9901 - val_loss: 0.0081 - val_categorical_accuracy: 0.9615
Epoch 23/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0017 - categorical_accuracy: 0.9929 - val_loss: 0.0082 - val_categorical_accuracy: 0.9617
Epoch 24/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0015 - categorical_accuracy: 0.9942 - val_loss: 0.0082 - val_categorical_accuracy: 0.9629
Epoch 25/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0014 - categorical_accuracy: 0.9951 - val_loss: 0.0082 - val_categorical_accuracy: 0.9632
Epoch 26/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0013 - categorical_accuracy: 0.9959 - val_loss: 0.0082 - val_categorical_accuracy: 0.9629
Epoch 27/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0012 - categorical_accuracy: 0.9961 - val_loss: 0.0083 - val_categorical_accuracy: 0.9630
Epoch 28/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9968 - val_loss: 0.0083 - val_categorical_accuracy: 0.9626

Epoch 00028: ReduceLROnPlateau reducing learning rate to 0.04000000059604645.
Epoch 29/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0010 - categorical_accuracy: 0.9972 - val_loss: 0.0083 - val_categorical_accuracy: 0.9633
Epoch 30/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.8884e-04 - categorical_accuracy: 0.9972 - val_loss: 0.0083 - val_categorical_accuracy: 0.9633
Epoch 31/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0010 - categorical_accuracy: 0.9970 - val_loss: 0.0083 - val_categorical_accuracy: 0.9634
Epoch 32/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.9449e-04 - categorical_accuracy: 0.9972 - val_loss: 0.0083 - val_categorical_accuracy: 0.9634
Epoch 33/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.9397e-04 - categorical_accuracy: 0.9969 - val_loss: 0.0083 - val_categorical_accuracy: 0.9635

Epoch 00033: ReduceLROnPlateau reducing learning rate to 0.007999999821186066.
Epoch 34/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.8460e-04 - categorical_accuracy: 0.9972 - val_loss: 0.0083 - val_categorical_accuracy: 0.9637
Epoch 35/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.1663e-04 - categorical_accuracy: 0.9975 - val_loss: 0.0083 - val_categorical_accuracy: 0.9638
Epoch 36/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.2656e-04 - categorical_accuracy: 0.9975 - val_loss: 0.0083 - val_categorical_accuracy: 0.9635
Epoch 37/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.2528e-04 - categorical_accuracy: 0.9973 - val_loss: 0.0083 - val_categorical_accuracy: 0.9637
Epoch 00037: early stopping
========= generating oof predictions 15:35:47 =========
========= generating test set predictions 15:35:48 =========
========= fitting 2 th model 15:36:11 =========
Epoch 1/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0963 - categorical_accuracy: 0.4074 - val_loss: 0.0618 - val_categorical_accuracy: 0.6194
Epoch 2/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0397 - categorical_accuracy: 0.7768 - val_loss: 0.0221 - val_categorical_accuracy: 0.8741
Epoch 3/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0259 - categorical_accuracy: 0.8588 - val_loss: 0.0250 - val_categorical_accuracy: 0.8597
Epoch 4/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0198 - categorical_accuracy: 0.8945 - val_loss: 0.0159 - val_categorical_accuracy: 0.9095
Epoch 5/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0166 - categorical_accuracy: 0.9126 - val_loss: 0.0146 - val_categorical_accuracy: 0.9173
Epoch 6/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0143 - categorical_accuracy: 0.9257 - val_loss: 0.0114 - val_categorical_accuracy: 0.9361
Epoch 7/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0125 - categorical_accuracy: 0.9349 - val_loss: 0.0187 - val_categorical_accuracy: 0.8969
Epoch 8/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0114 - categorical_accuracy: 0.9406 - val_loss: 0.0098 - val_categorical_accuracy: 0.9465
Epoch 9/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0101 - categorical_accuracy: 0.9474 - val_loss: 0.0101 - val_categorical_accuracy: 0.9430
Epoch 10/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0093 - categorical_accuracy: 0.9524 - val_loss: 0.0109 - val_categorical_accuracy: 0.9400
Epoch 11/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0086 - categorical_accuracy: 0.9545 - val_loss: 0.0097 - val_categorical_accuracy: 0.9459
Epoch 12/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0077 - categorical_accuracy: 0.9606 - val_loss: 0.0093 - val_categorical_accuracy: 0.9509
Epoch 13/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0072 - categorical_accuracy: 0.9622 - val_loss: 0.0114 - val_categorical_accuracy: 0.9404
Epoch 14/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0066 - categorical_accuracy: 0.9655 - val_loss: 0.0112 - val_categorical_accuracy: 0.9407
Epoch 15/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0058 - categorical_accuracy: 0.9706 - val_loss: 0.0099 - val_categorical_accuracy: 0.9481
Epoch 16/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0053 - categorical_accuracy: 0.9725 - val_loss: 0.0105 - val_categorical_accuracy: 0.9457
Epoch 17/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0050 - categorical_accuracy: 0.9745 - val_loss: 0.0090 - val_categorical_accuracy: 0.9535
Epoch 18/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0046 - categorical_accuracy: 0.9762 - val_loss: 0.0112 - val_categorical_accuracy: 0.9445
Epoch 19/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0043 - categorical_accuracy: 0.9782 - val_loss: 0.0105 - val_categorical_accuracy: 0.9459
Epoch 20/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0039 - categorical_accuracy: 0.9796 - val_loss: 0.0100 - val_categorical_accuracy: 0.9509
Epoch 21/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0037 - categorical_accuracy: 0.9813 - val_loss: 0.0149 - val_categorical_accuracy: 0.9304
Epoch 22/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0033 - categorical_accuracy: 0.9833 - val_loss: 0.0110 - val_categorical_accuracy: 0.9478
Epoch 23/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0031 - categorical_accuracy: 0.9848 - val_loss: 0.0104 - val_categorical_accuracy: 0.9509

Epoch 00023: ReduceLROnPlateau reducing learning rate to 0.2.
Epoch 24/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0020 - categorical_accuracy: 0.9912 - val_loss: 0.0083 - val_categorical_accuracy: 0.9609
Epoch 25/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0016 - categorical_accuracy: 0.9939 - val_loss: 0.0083 - val_categorical_accuracy: 0.9617
Epoch 26/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0014 - categorical_accuracy: 0.9952 - val_loss: 0.0083 - val_categorical_accuracy: 0.9615
Epoch 27/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0013 - categorical_accuracy: 0.9953 - val_loss: 0.0084 - val_categorical_accuracy: 0.9611
Epoch 28/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9962 - val_loss: 0.0084 - val_categorical_accuracy: 0.9620
Epoch 29/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9961 - val_loss: 0.0085 - val_categorical_accuracy: 0.9620
Epoch 30/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0010 - categorical_accuracy: 0.9967 - val_loss: 0.0085 - val_categorical_accuracy: 0.9608

Epoch 00030: ReduceLROnPlateau reducing learning rate to 0.04000000059604645.
Epoch 31/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.7991e-04 - categorical_accuracy: 0.9968 - val_loss: 0.0083 - val_categorical_accuracy: 0.9620
Epoch 32/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.7578e-04 - categorical_accuracy: 0.9968 - val_loss: 0.0083 - val_categorical_accuracy: 0.9620
Epoch 33/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.4372e-04 - categorical_accuracy: 0.9974 - val_loss: 0.0083 - val_categorical_accuracy: 0.9623
Epoch 34/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.2612e-04 - categorical_accuracy: 0.9974 - val_loss: 0.0084 - val_categorical_accuracy: 0.9618
Epoch 35/65535
420/420 [==============================] - 20s 47ms/step - loss: 8.7895e-04 - categorical_accuracy: 0.9976 - val_loss: 0.0083 - val_categorical_accuracy: 0.9611

Epoch 00035: ReduceLROnPlateau reducing learning rate to 0.007999999821186066.
Epoch 36/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.3784e-04 - categorical_accuracy: 0.9972 - val_loss: 0.0083 - val_categorical_accuracy: 0.9614
Epoch 37/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.1877e-04 - categorical_accuracy: 0.9973 - val_loss: 0.0083 - val_categorical_accuracy: 0.9617
Epoch 38/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.2391e-04 - categorical_accuracy: 0.9973 - val_loss: 0.0083 - val_categorical_accuracy: 0.9617
Epoch 39/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.0631e-04 - categorical_accuracy: 0.9973 - val_loss: 0.0083 - val_categorical_accuracy: 0.9616
Epoch 40/65535
420/420 [==============================] - 20s 47ms/step - loss: 8.7569e-04 - categorical_accuracy: 0.9980 - val_loss: 0.0083 - val_categorical_accuracy: 0.9617

Epoch 00040: ReduceLROnPlateau reducing learning rate to 0.0015999998897314072.
Epoch 41/65535
420/420 [==============================] - 20s 47ms/step - loss: 8.9197e-04 - categorical_accuracy: 0.9979 - val_loss: 0.0083 - val_categorical_accuracy: 0.9619
Epoch 00041: early stopping
========= generating oof predictions 15:49:47 =========
========= generating test set predictions 15:49:48 =========
========= fitting 3 th model 15:50:11 =========
Epoch 1/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.1000 - categorical_accuracy: 0.3832 - val_loss: 0.0686 - val_categorical_accuracy: 0.5691
Epoch 2/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0400 - categorical_accuracy: 0.7759 - val_loss: 0.0210 - val_categorical_accuracy: 0.8825
Epoch 3/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0258 - categorical_accuracy: 0.8624 - val_loss: 0.0204 - val_categorical_accuracy: 0.8867
Epoch 4/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0198 - categorical_accuracy: 0.8965 - val_loss: 0.0435 - val_categorical_accuracy: 0.7583
Epoch 5/65535
420/420 [==============================] - 20s 46ms/step - loss: 0.0166 - categorical_accuracy: 0.9133 - val_loss: 0.0131 - val_categorical_accuracy: 0.9251
Epoch 6/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0143 - categorical_accuracy: 0.9265 - val_loss: 0.0128 - val_categorical_accuracy: 0.9308
Epoch 7/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0125 - categorical_accuracy: 0.9356 - val_loss: 0.0151 - val_categorical_accuracy: 0.9199
Epoch 8/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0113 - categorical_accuracy: 0.9426 - val_loss: 0.0160 - val_categorical_accuracy: 0.9119
Epoch 9/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0101 - categorical_accuracy: 0.9475 - val_loss: 0.0108 - val_categorical_accuracy: 0.9400
Epoch 10/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0092 - categorical_accuracy: 0.9517 - val_loss: 0.0115 - val_categorical_accuracy: 0.9404
Epoch 11/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0082 - categorical_accuracy: 0.9572 - val_loss: 0.0144 - val_categorical_accuracy: 0.9283
Epoch 12/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0078 - categorical_accuracy: 0.9589 - val_loss: 0.0095 - val_categorical_accuracy: 0.9492
Epoch 13/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0068 - categorical_accuracy: 0.9644 - val_loss: 0.0136 - val_categorical_accuracy: 0.9362
Epoch 14/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0063 - categorical_accuracy: 0.9667 - val_loss: 0.0251 - val_categorical_accuracy: 0.8825
Epoch 15/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0060 - categorical_accuracy: 0.9681 - val_loss: 0.0108 - val_categorical_accuracy: 0.9441
Epoch 16/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0055 - categorical_accuracy: 0.9708 - val_loss: 0.0144 - val_categorical_accuracy: 0.9334
Epoch 17/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0047 - categorical_accuracy: 0.9759 - val_loss: 0.0122 - val_categorical_accuracy: 0.9421
Epoch 18/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0044 - categorical_accuracy: 0.9766 - val_loss: 0.0095 - val_categorical_accuracy: 0.9554

Epoch 00018: ReduceLROnPlateau reducing learning rate to 0.2.
Epoch 19/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0031 - categorical_accuracy: 0.9847 - val_loss: 0.0086 - val_categorical_accuracy: 0.9584
Epoch 20/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0026 - categorical_accuracy: 0.9883 - val_loss: 0.0086 - val_categorical_accuracy: 0.9580
Epoch 21/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0023 - categorical_accuracy: 0.9901 - val_loss: 0.0087 - val_categorical_accuracy: 0.9582
Epoch 22/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0022 - categorical_accuracy: 0.9906 - val_loss: 0.0087 - val_categorical_accuracy: 0.9585
Epoch 23/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0020 - categorical_accuracy: 0.9919 - val_loss: 0.0086 - val_categorical_accuracy: 0.9596
Epoch 24/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0018 - categorical_accuracy: 0.9927 - val_loss: 0.0087 - val_categorical_accuracy: 0.9586
Epoch 25/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0017 - categorical_accuracy: 0.9939 - val_loss: 0.0083 - val_categorical_accuracy: 0.9600
Epoch 26/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0016 - categorical_accuracy: 0.9944 - val_loss: 0.0087 - val_categorical_accuracy: 0.9596
Epoch 27/65535
420/420 [==============================] - 20s 46ms/step - loss: 0.0016 - categorical_accuracy: 0.9941 - val_loss: 0.0086 - val_categorical_accuracy: 0.9593
Epoch 28/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0015 - categorical_accuracy: 0.9946 - val_loss: 0.0086 - val_categorical_accuracy: 0.9599
Epoch 29/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0014 - categorical_accuracy: 0.9949 - val_loss: 0.0090 - val_categorical_accuracy: 0.9591
Epoch 30/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0014 - categorical_accuracy: 0.9955 - val_loss: 0.0088 - val_categorical_accuracy: 0.9599
Epoch 31/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0013 - categorical_accuracy: 0.9959 - val_loss: 0.0090 - val_categorical_accuracy: 0.9595

Epoch 00031: ReduceLROnPlateau reducing learning rate to 0.04000000059604645.
Epoch 32/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9964 - val_loss: 0.0087 - val_categorical_accuracy: 0.9610
Epoch 33/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9969 - val_loss: 0.0087 - val_categorical_accuracy: 0.9613
Epoch 34/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9968 - val_loss: 0.0087 - val_categorical_accuracy: 0.9614
Epoch 35/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9964 - val_loss: 0.0086 - val_categorical_accuracy: 0.9614
Epoch 36/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9968 - val_loss: 0.0088 - val_categorical_accuracy: 0.9618

Epoch 00036: ReduceLROnPlateau reducing learning rate to 0.007999999821186066.
Epoch 37/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9966 - val_loss: 0.0086 - val_categorical_accuracy: 0.9615
Epoch 38/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9965 - val_loss: 0.0086 - val_categorical_accuracy: 0.9609
Epoch 39/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9965 - val_loss: 0.0087 - val_categorical_accuracy: 0.9610
Epoch 40/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9966 - val_loss: 0.0087 - val_categorical_accuracy: 0.9609
Epoch 00040: early stopping
========= generating oof predictions 16:03:18 =========
========= generating test set predictions 16:03:20 =========
========= fitting 4 th model 16:03:42 =========
Epoch 1/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.1016 - categorical_accuracy: 0.3735 - val_loss: 0.0437 - val_categorical_accuracy: 0.7394
Epoch 2/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0412 - categorical_accuracy: 0.7664 - val_loss: 0.0299 - val_categorical_accuracy: 0.8270
Epoch 3/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0267 - categorical_accuracy: 0.8574 - val_loss: 0.0251 - val_categorical_accuracy: 0.8538
Epoch 4/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0201 - categorical_accuracy: 0.8941 - val_loss: 0.0133 - val_categorical_accuracy: 0.9270
Epoch 5/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0168 - categorical_accuracy: 0.9136 - val_loss: 0.0129 - val_categorical_accuracy: 0.9289
Epoch 6/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0146 - categorical_accuracy: 0.9234 - val_loss: 0.0126 - val_categorical_accuracy: 0.9299
Epoch 7/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0128 - categorical_accuracy: 0.9330 - val_loss: 0.0111 - val_categorical_accuracy: 0.9368
Epoch 8/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0113 - categorical_accuracy: 0.9406 - val_loss: 0.0145 - val_categorical_accuracy: 0.9218
Epoch 9/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0103 - categorical_accuracy: 0.9466 - val_loss: 0.0159 - val_categorical_accuracy: 0.9176
Epoch 10/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0092 - categorical_accuracy: 0.9520 - val_loss: 0.0100 - val_categorical_accuracy: 0.9453
Epoch 11/65535
420/420 [==============================] - 19s 46ms/step - loss: 0.0087 - categorical_accuracy: 0.9549 - val_loss: 0.0100 - val_categorical_accuracy: 0.9472
Epoch 12/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0076 - categorical_accuracy: 0.9604 - val_loss: 0.0098 - val_categorical_accuracy: 0.9493
Epoch 13/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0070 - categorical_accuracy: 0.9641 - val_loss: 0.0095 - val_categorical_accuracy: 0.9510
Epoch 14/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0064 - categorical_accuracy: 0.9662 - val_loss: 0.0119 - val_categorical_accuracy: 0.9429
Epoch 15/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0060 - categorical_accuracy: 0.9694 - val_loss: 0.0101 - val_categorical_accuracy: 0.9489
Epoch 16/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0054 - categorical_accuracy: 0.9715 - val_loss: 0.0089 - val_categorical_accuracy: 0.9551
Epoch 17/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0050 - categorical_accuracy: 0.9741 - val_loss: 0.0113 - val_categorical_accuracy: 0.9454
Epoch 18/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0045 - categorical_accuracy: 0.9761 - val_loss: 0.0092 - val_categorical_accuracy: 0.9553
Epoch 19/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0045 - categorical_accuracy: 0.9766 - val_loss: 0.0102 - val_categorical_accuracy: 0.9495
Epoch 20/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0038 - categorical_accuracy: 0.9811 - val_loss: 0.0094 - val_categorical_accuracy: 0.9541
Epoch 21/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0037 - categorical_accuracy: 0.9816 - val_loss: 0.0106 - val_categorical_accuracy: 0.9514
Epoch 22/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0032 - categorical_accuracy: 0.9840 - val_loss: 0.0102 - val_categorical_accuracy: 0.9524

Epoch 00022: ReduceLROnPlateau reducing learning rate to 0.2.
Epoch 23/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0020 - categorical_accuracy: 0.9911 - val_loss: 0.0083 - val_categorical_accuracy: 0.9624
Epoch 24/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0017 - categorical_accuracy: 0.9932 - val_loss: 0.0083 - val_categorical_accuracy: 0.9615
Epoch 25/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0015 - categorical_accuracy: 0.9943 - val_loss: 0.0084 - val_categorical_accuracy: 0.9612
Epoch 26/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0013 - categorical_accuracy: 0.9956 - val_loss: 0.0086 - val_categorical_accuracy: 0.9619
Epoch 27/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9958 - val_loss: 0.0085 - val_categorical_accuracy: 0.9617
Epoch 28/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9961 - val_loss: 0.0088 - val_categorical_accuracy: 0.9610
Epoch 29/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9968 - val_loss: 0.0084 - val_categorical_accuracy: 0.9614

Epoch 00029: ReduceLROnPlateau reducing learning rate to 0.04000000059604645.
Epoch 30/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0010 - categorical_accuracy: 0.9967 - val_loss: 0.0084 - val_categorical_accuracy: 0.9618
Epoch 31/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0010 - categorical_accuracy: 0.9972 - val_loss: 0.0084 - val_categorical_accuracy: 0.9624
Epoch 32/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.5633e-04 - categorical_accuracy: 0.9971 - val_loss: 0.0084 - val_categorical_accuracy: 0.9621
Epoch 33/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.5856e-04 - categorical_accuracy: 0.9971 - val_loss: 0.0084 - val_categorical_accuracy: 0.9624
Epoch 34/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.2325e-04 - categorical_accuracy: 0.9977 - val_loss: 0.0084 - val_categorical_accuracy: 0.9627

Epoch 00034: ReduceLROnPlateau reducing learning rate to 0.007999999821186066.
Epoch 35/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.0731e-04 - categorical_accuracy: 0.9974 - val_loss: 0.0084 - val_categorical_accuracy: 0.9624
Epoch 36/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.2444e-04 - categorical_accuracy: 0.9974 - val_loss: 0.0084 - val_categorical_accuracy: 0.9629
Epoch 37/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.0547e-04 - categorical_accuracy: 0.9974 - val_loss: 0.0084 - val_categorical_accuracy: 0.9625
Epoch 38/65535
420/420 [==============================] - 20s 47ms/step - loss: 9.4936e-04 - categorical_accuracy: 0.9973 - val_loss: 0.0084 - val_categorical_accuracy: 0.9623
Epoch 00038: early stopping
========= generating oof predictions 16:16:14 =========
========= generating test set predictions 16:16:15 =========
========= fitting 5 th model 16:16:38 =========
Epoch 1/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0966 - categorical_accuracy: 0.4091 - val_loss: 0.0906 - val_categorical_accuracy: 0.4747
Epoch 2/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0399 - categorical_accuracy: 0.7731 - val_loss: 0.0275 - val_categorical_accuracy: 0.8393
Epoch 3/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0262 - categorical_accuracy: 0.8594 - val_loss: 0.0208 - val_categorical_accuracy: 0.8800
Epoch 4/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0197 - categorical_accuracy: 0.8955 - val_loss: 0.0171 - val_categorical_accuracy: 0.9015
Epoch 5/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0167 - categorical_accuracy: 0.9117 - val_loss: 0.0139 - val_categorical_accuracy: 0.9227
Epoch 6/65535
420/420 [==============================] - 20s 48ms/step - loss: 0.0139 - categorical_accuracy: 0.9281 - val_loss: 0.0127 - val_categorical_accuracy: 0.9304
Epoch 7/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0122 - categorical_accuracy: 0.9360 - val_loss: 0.0114 - val_categorical_accuracy: 0.9395
Epoch 8/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0108 - categorical_accuracy: 0.9431 - val_loss: 0.0109 - val_categorical_accuracy: 0.9401
Epoch 9/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0100 - categorical_accuracy: 0.9473 - val_loss: 0.0105 - val_categorical_accuracy: 0.9417
Epoch 10/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0089 - categorical_accuracy: 0.9530 - val_loss: 0.0107 - val_categorical_accuracy: 0.9416
Epoch 11/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0080 - categorical_accuracy: 0.9576 - val_loss: 0.0098 - val_categorical_accuracy: 0.9500
Epoch 12/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0074 - categorical_accuracy: 0.9611 - val_loss: 0.0145 - val_categorical_accuracy: 0.9264
Epoch 13/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0066 - categorical_accuracy: 0.9656 - val_loss: 0.0095 - val_categorical_accuracy: 0.9503
Epoch 14/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0059 - categorical_accuracy: 0.9692 - val_loss: 0.0111 - val_categorical_accuracy: 0.9433
Epoch 15/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0056 - categorical_accuracy: 0.9716 - val_loss: 0.0114 - val_categorical_accuracy: 0.9415
Epoch 16/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0050 - categorical_accuracy: 0.9738 - val_loss: 0.0102 - val_categorical_accuracy: 0.9492
Epoch 17/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0047 - categorical_accuracy: 0.9746 - val_loss: 0.0117 - val_categorical_accuracy: 0.9391
Epoch 18/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0042 - categorical_accuracy: 0.9783 - val_loss: 0.0114 - val_categorical_accuracy: 0.9454
Epoch 19/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0039 - categorical_accuracy: 0.9797 - val_loss: 0.0094 - val_categorical_accuracy: 0.9541

Epoch 00019: ReduceLROnPlateau reducing learning rate to 0.2.
Epoch 20/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0025 - categorical_accuracy: 0.9883 - val_loss: 0.0085 - val_categorical_accuracy: 0.9603
Epoch 21/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0021 - categorical_accuracy: 0.9908 - val_loss: 0.0087 - val_categorical_accuracy: 0.9596
Epoch 22/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0018 - categorical_accuracy: 0.9923 - val_loss: 0.0087 - val_categorical_accuracy: 0.9591
Epoch 23/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0016 - categorical_accuracy: 0.9935 - val_loss: 0.0088 - val_categorical_accuracy: 0.9594
Epoch 24/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0016 - categorical_accuracy: 0.9940 - val_loss: 0.0089 - val_categorical_accuracy: 0.9587
Epoch 25/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0015 - categorical_accuracy: 0.9947 - val_loss: 0.0089 - val_categorical_accuracy: 0.9594
Epoch 26/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0013 - categorical_accuracy: 0.9953 - val_loss: 0.0090 - val_categorical_accuracy: 0.9593

Epoch 00026: ReduceLROnPlateau reducing learning rate to 0.04000000059604645.
Epoch 27/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0013 - categorical_accuracy: 0.9954 - val_loss: 0.0087 - val_categorical_accuracy: 0.9603
Epoch 28/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0013 - categorical_accuracy: 0.9959 - val_loss: 0.0088 - val_categorical_accuracy: 0.9609
Epoch 29/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9960 - val_loss: 0.0088 - val_categorical_accuracy: 0.9612
Epoch 30/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9967 - val_loss: 0.0088 - val_categorical_accuracy: 0.9609
Epoch 31/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9959 - val_loss: 0.0088 - val_categorical_accuracy: 0.9605

Epoch 00031: ReduceLROnPlateau reducing learning rate to 0.007999999821186066.
Epoch 32/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0012 - categorical_accuracy: 0.9963 - val_loss: 0.0088 - val_categorical_accuracy: 0.9608
Epoch 33/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9968 - val_loss: 0.0088 - val_categorical_accuracy: 0.9609
Epoch 34/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9967 - val_loss: 0.0088 - val_categorical_accuracy: 0.9610
Epoch 35/65535
420/420 [==============================] - 20s 47ms/step - loss: 0.0011 - categorical_accuracy: 0.9966 - val_loss: 0.0088 - val_categorical_accuracy: 0.9609
Epoch 00035: early stopping
========= generating oof predictions 16:28:10 =========
========= generating test set predictions 16:28:12 =========
train loss avg 0.0009971001205998748 -- std 9.279935002490811e-05, val loss avg 0.00850112652382826 -- std 0.0002100841935491866
train acc avg 0.9971507202782609 -- std 0.00047798726334193667, val acc avg 0.9619190151246345 -- std 0.0010429576439432635
mean nb epochs 38.2
dump oof predicted probs
dump test set predicted probs
